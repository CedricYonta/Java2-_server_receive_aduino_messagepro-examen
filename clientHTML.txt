<!DOCTYPE html>
<html>
<head>
  <title>Dernier enregistrement de la table</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <table id="mytable">
    <thead>
      <tr>
        <th>Column1</th>
        <th>Column2</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  <script>
    $(document).ready(function() {
      updateData();
    });

    function updateData() {
      $.ajax({
        url: 'get_latest_record.php', // chemin vers le script PHP qui récupère le dernier enregistrement
        method: 'GET',
        dataType: 'json', // le script PHP renvoie les données au format JSON
        success: function(data) {
          // Vider le contenu du tableau
          $('#mytable tbody').empty();

          // Ajouter une nouvelle ligne au tableau avec les données récupérées
          var row = $('<tr>');
          row.append($('<td>').text(data.column1));
          row.append($('<td>').text(data.column2));
          $('#mytable tbody').append(row);
        },
        complete: function() {
          // Répéter l'opération toutes les secondes
          setTimeout(updateData, 1000);
        }
      });
    }
  </script>
</body>
</html>



<?php
// Paramètres de connexion à la base de données
$host = 'localhost';
$dbname = 'dvdrental';
$user = 'postgres';
$password = 'cedric';

// Connexion à la base de données
$dsn = "pgsql:host=$host;dbname=$dbname;user=$user;password=$password";
$db = new PDO($dsn);

// Exécution de la requête SQL pour récupérer le dernier enregistrement
$stmt = $db->query("SELECT * FROM capteur ORDER BY user_id DESC LIMIT 1");
$row = $stmt->fetch(PDO::FETCH_ASSOC);

// Envoi des données au format JSON
header('Content-Type: application/json');
echo json_encode($row);
